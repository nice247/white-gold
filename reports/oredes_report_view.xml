<odoo>
    <record id="sale_invoice_report" model="ir.actions.report">
        <field name="name">Sale Invoice Report</field>
        <field name="model">historical.sales</field>
        <field name="report_type">qweb-pdf</field>
        <field name="binding_model_id" ref="model_historical_sales"/>
        <field name="binding_type">report</field>
        <field name="report_name">white_gold.sale_invoice_template</field>
    </record>

    <template id="sale_invoice_template">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <style>
                    .invoice-report {
                    font-family: Arial, sans-serif;
                    line-height: 1.6;
                    color: #333;
                    }

                    .invoice-header {
                    margin-bottom: 30px;
                    padding-bottom: 15px;
                    border-bottom: 2px solid #007bff;
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    }

                    .invoice-info {
                    flex-grow: 1;
                    }

                    .invoice-details {
                    margin-bottom: 25px;
                    }

                    .detail-item {
                    margin-bottom: 10px;
                    display: flex;
                    }

                    .detail-label {
                    font-weight: bold;
                    width: 140px;
                    flex-shrink: 0;
                    }

                    .detail-value {
                    flex-grow: 1;
                    }

                    .products-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin: 25px 0;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                    }

                    .products-table th {
                    background: #343a40;
                    color: white;
                    padding: 12px;
                    text-align: left;
                    border: 1px solid #454d55;
                    font-weight: bold;
                    }

                    .products-table td {
                    padding: 10px;
                    border: 1px solid #dee2e6;
                    }

                    .products-table tr:nth-child(even) {
                    background: #f8f9fa;
                    }

                    .products-table .center {
                    text-align: center;
                    }

                    .products-table .right {
                    text-align: right;
                    }

                    .total-row {
                    background: #e9ecef !important;
                    font-weight: bold;
                    border-top: 2px solid #495057;
                    }

                    .summary-section {
                    background: #e7f3ff;
                    padding: 15px;
                    border-radius: 5px;
                    margin: 20px 0;
                    border-left: 4px solid #007bff;
                    }

                    .summary-item {
                    display: inline-block;
                    margin-right: 30px;
                    font-weight: bold;
                    font-size: 16px;
                    }

                    .footer {
                    margin-top: 40px;
                    padding-top: 20px;
                    border-top: 1px solid #ddd;
                    text-align: center;
                    color: #6c757d;
                    font-size: 12px;
                    }

                    .company-info {
                    text-align: left;
                    margin-bottom: 20px;
                    }

                    .company-name {
                    font-size: 24px;
                    font-weight: bold;
                    color: #007bff;
                    margin-bottom: 5px;
                    }

                    .invoice-title {
                    font-size: 28px;
                    font-weight: bold;
                    color: #343a40;
                    margin: 0;
                    }

                    .customer-section {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 5px;
                    margin: 20px 0;
                    border-left: 4px solid #28a745;
                    }

                    .customer-title {
                    color: #28a745;
                    margin-top: 0;
                    font-size: 18px;
                    }
                </style>

                <div class="invoice-report">
                    <!-- Company Header -->
                    <div class="company-info">
                        <div class="company-name">Nile Dairy and Foods Co.</div>
                        <div>Al-Niel Complex, Building 12, Office 3</div>
                        <div>Khartoum, State 121333</div>
                        <div>Phone: +249902642768</div>
                        <div>Email: info@niledairy.com</div>
                    </div>

                    <!-- Invoice Header -->
                    <div class="invoice-header">
                        <div class="invoice-info">
                            <div class="detail-item">
                                <span class="detail-label">Invoice No:</span>
                                <span class="detail-value" t-esc="docs[0].ref"/>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Information -->
                    <div class="customer-section">
                        <h3 class="customer-title">Customer Information</h3>
                        <div class="detail-item">
                            <span class="detail-label">Customer Name:</span>
                            <span class="detail-value" t-esc="docs[0].customer_name or 'Not specified'"/>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value" t-esc="docs[0].customer_email or 'Not specified'"/>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value" t-esc="docs[0].customer_phone or 'Not specified'"/>
                        </div>
                    </div>

                    <!-- Products Table -->
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th colspan="6"
                                    style="text-align: center; background: #495057; font-size: 16px; color: white;">
                                    PRODUCTS DETAILS
                                </th>
                            </tr>
                            <tr>
                                <th class="center" style="width: 5%;">#</th>
                                <th style="width: 25%;">Product Name</th>
                                <th style="width: 15%;">Product Code</th>
                                <th class="center" style="width: 15%;">Quantity</th>
                                <th class="right" style="width: 20%;">Unit Price ($)</th>
                                <th class="right" style="width: 20%;">Total Amount ($)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Product Lines -->
                            <t t-set="sale_lines" t-value="docs[0].sale_line_ids.sorted(key=lambda r: r.product_name)"/>

                            <tr t-foreach="sale_lines" t-as="line">
                                <td class="center" t-esc="line_index + 1"/>
                                <td>
                                    <t t-esc="{'milk': 'Milk', 'cheese': 'Cheese', 'yogurt': 'Yogurt', 'cream': 'Cream', 'butter': 'Butter'}.get(line.product_name, line.product_name)"/>
                                </td>
                                <td t-esc="line.product_code"/>
                                <td class="center" t-esc="line.quantity"/>
                                <td class="right" t-esc="'%.2f' % line.unit_price"/>
                                <td class="right" t-esc="'%.2f' % line.total_amount"/>
                            </tr>

                            <!-- إذا لم يكن هناك products -->
                            <tr t-if="not sale_lines">
                                <td colspan="6" style="text-align: center; color: #6c757d; font-style: italic;">
                                    No products found in this sale
                                </td>
                            </tr>

                            <!-- Total Rows -->
                            <tr class="total-row">
                                <td colspan="3" style="text-align: right;">
                                    <strong>Subtotal:</strong>
                                </td>
                                <td class="center" t-esc="docs[0].total_quantity"/>
                                <td></td>
                                <td class="right">
                                    <strong t-esc="'%.2f' % (docs[0].total_amount or 0)"/>
                                </td>
                            </tr>
                            <tr class="total-row">
                                <td colspan="5" style="text-align: right;">
                                    <strong>Total Amount:</strong>
                                </td>
                                <td class="right">
                                    <strong style="font-size: 18px; color: #007bff;"
                                            t-esc="'$%.2f' % (docs[0].total_amount or 0)"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Summary Section -->
                    <div class="summary-section">
                        <span class="summary-item">
                            Total Products:
                            <span t-esc="len(sale_lines)"/>
                        </span>
                        <span class="summary-item">
                            Total Quantity:
                            <span t-esc="docs[0].total_quantity"/>
                        </span>
                        <span class="summary-item">
                            Total Amount:
                            <span t-esc="'$%.2f' % (docs[0].total_amount or 0)"/>
                        </span>
                    </div>

                    <!-- Footer -->
                    <div class="footer">
                        <p>
                            Invoice generated on
                            <span t-esc="datetime.datetime.now().strftime('%Y-%m-%d at %H:%M')"/>
                            |
                            Page
                            <span t-esc="env.context.get('report_pagenumber', 1)"/>
                            of
                            <span t-esc="env.context.get('report_pagecount', 1)"/>
                        </p>
                        <p>Thank you for your business! | White Gold Company</p>
                        <p style="margin-top: 10px; font-size: 10px;">
                            This is a computer-generated invoice. No signature required.
                        </p>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>